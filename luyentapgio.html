<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học Nói Thời Gian Tiếng Trung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Nunito:wght@400;700&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f3f4f6;
        }
        
        .hanzi-text {
            font-family: 'Noto Sans SC', sans-serif;
        }

        .clock-face {
            transition: all 0.5s cubic-bezier(0.4, 2.08, 0.55, 0.44);
        }

        .hand {
            transition: transform 0.5s cubic-bezier(0.4, 2.08, 0.55, 0.44);
            transform-origin: bottom center;
            border-radius: 999px;
        }

        /* Hiệu ứng nút bấm */
        .btn-press:active {
            transform: scale(0.95);
        }
        
        .active-hour {
            background-color: #d97706 !important; /* amber-600 */
            color: white;
            transform: scale(1.05);
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.2);
        }

        .active-minute {
            background-color: #7c3aed !important; /* violet-600 */
            color: white;
            transform: scale(1.05);
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Phần Đồng hồ (Trái/Trên) -->
    <div class="w-full md:w-1/2 bg-white flex flex-col items-center justify-center p-2 md:p-4 relative shadow-lg z-10">
        
        <h1 class="text-xl md:text-2xl font-bold text-gray-700 mb-2 md:mb-6 text-center">
            <i class="fas fa-clock text-purple-600 mr-2"></i>Thực hành Thời gian
        </h1>

        <!-- Clock Container - Đã thu nhỏ kích thước -->
        <div class="relative w-[240px] h-[240px] md:w-[320px] md:h-[320px] flex-shrink-0">
            <!-- Outer Ring (Minutes) -->
            <div class="absolute inset-0 rounded-full bg-[#7d41a6] border-4 border-[#6b3690] shadow-xl flex items-center justify-center">
                <!-- Inner White Face -->
                <div class="w-[80%] h-[80%] bg-white rounded-full relative shadow-inner"></div>
            </div>

            <!-- Numbers Container -->
            <div id="clock-numbers" class="absolute inset-0 pointer-events-none">
                <!-- Javascript will populate numbers here -->
            </div>

            <!-- Hands Container -->
            <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                <!-- Center Dot -->
                <div class="w-3 h-3 md:w-4 md:h-4 bg-black rounded-full z-50 shadow-md"></div>
                
                <!-- Hour Hand -->
                <div id="hour-hand" class="hand w-1.5 md:w-2 bg-black absolute bottom-1/2 left-1/2 -ml-0.75 md:-ml-1 h-[25%] z-30 origin-bottom"></div>
                
                <!-- Minute Hand -->
                <div id="minute-hand" class="hand w-1 md:w-1.5 bg-red-600 absolute bottom-1/2 left-1/2 -ml-0.5 md:-ml-0.75 h-[35%] z-40 origin-bottom"></div>
            </div>
            
            <!-- Digital Display (Optional helper) -->
            <div class="absolute bottom-[25%] left-1/2 transform -translate-x-1/2 bg-gray-100 px-2 py-0.5 rounded-full text-gray-500 font-mono text-xs md:text-sm opacity-50">
                <span id="digital-time">12:00</span>
            </div>
        </div>

        <!-- Result Section -->
        <!-- Thêm min-h (chiều cao tối thiểu) để giữ chỗ, tránh nhảy layout -->
        <div class="mt-4 w-full max-w-md text-center min-h-[160px] flex flex-col items-center">
            <button onclick="toggleResult()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full shadow-lg transition transform hover:-translate-y-1 mb-2 flex items-center justify-center mx-auto text-sm md:text-base">
                <i class="fas fa-eye mr-2"></i> Xem Kết Quả
            </button>
            
            <div id="result-box" class="hidden w-full transform transition-all duration-300 bg-yellow-50 border-l-4 border-yellow-400 rounded shadow overflow-hidden text-left">
                <!-- Primary Result -->
                <div class="p-3 pb-1">
                    <p class="text-[10px] md:text-xs text-gray-500 font-bold uppercase mb-1">Cách đọc chính (Standard):</p>
                    <p id="pinyin-result" class="text-lg md:text-xl text-gray-600 font-semibold mb-0 leading-tight">shí èr diǎn</p>
                    <p id="hanzi-result" class="text-2xl md:text-3xl text-purple-700 font-bold hanzi-text leading-tight">十二点</p>
                </div>

                <!-- Alternatives -->
                <div id="alternatives-container" class="bg-yellow-100 p-2 md:p-3 border-t border-yellow-200 hidden">
                    <p class="text-[10px] text-gray-500 font-bold uppercase mb-1">Cách đọc khác:</p>
                    <ul id="alternatives-list" class="space-y-1 md:space-y-2">
                        <!-- JS renders here -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Phần Điều khiển (Phải/Dưới) -->
    <div class="w-full md:w-1/2 bg-gray-50 p-4 md:p-8 overflow-y-auto border-l border-gray-200">
        
        <!-- Instruction -->
        <div class="mb-6 bg-blue-100 text-blue-800 p-3 rounded-lg text-sm flex items-start">
            <i class="fas fa-info-circle mt-1 mr-2"></i>
            <div>
                <span class="font-bold">Mẹo:</span> Hãy thử các mốc đặc biệt để xem nhiều cách đọc:
                <ul class="list-disc ml-4 mt-1">
                    <li>15 phút (一刻 - 1 khắc)</li>
                    <li>30 phút (半 - rưỡi)</li>
                    <li>45 phút trở lên (差 - kém)</li>
                </ul>
            </div>
        </div>

        <!-- Hours Control -->
        <div class="mb-8">
            <div class="bg-yellow-400 text-white font-bold text-center py-2 rounded-t-lg shadow-sm text-lg uppercase tracking-wider">
                Giờ (Hours)
            </div>
            <div class="grid grid-cols-3 gap-2 md:gap-3 bg-white p-4 rounded-b-lg shadow-sm border border-yellow-200" id="hours-grid">
                <!-- Generated by JS -->
            </div>
        </div>

        <!-- Minutes Control -->
        <div class="mb-8">
            <div class="bg-[#8b4bb6] text-white font-bold text-center py-2 rounded-t-lg shadow-sm text-lg uppercase tracking-wider">
                Phút (Minutes)
            </div>
            <div class="grid grid-cols-3 gap-2 md:gap-3 bg-white p-4 rounded-b-lg shadow-sm border border-purple-200" id="minutes-grid">
                <!-- Generated by JS -->
            </div>
        </div>
        
    </div>

    <script>
        // State
        let currentHour = 12;
        let currentMinute = 0; // 0-59

        const hoursGrid = document.getElementById('hours-grid');
        const minutesGrid = document.getElementById('minutes-grid');
        const clockNumbers = document.getElementById('clock-numbers');
        
        // --- Initialization ---

        function init() {
            renderClockFace();
            renderButtons();
            // FIXED: Changed updateClock(12, 0) to updateUI() as variables are already set
            updateUI(); 
        }

        // --- Rendering ---

        function renderClockFace() {
            // Render Hour numbers (1-12) - Inner
            for (let i = 1; i <= 12; i++) {
                const angle = i * 30;
                const radius = 33; // % from center
                const x = 50 + radius * Math.sin(angle * Math.PI / 180);
                const y = 50 - radius * Math.cos(angle * Math.PI / 180);
                
                const el = document.createElement('div');
                // Giảm font size số giờ
                el.className = 'absolute text-lg md:text-xl font-bold text-black transform -translate-x-1/2 -translate-y-1/2';
                el.style.left = `${x}%`;
                el.style.top = `${y}%`;
                el.innerText = i;
                clockNumbers.appendChild(el);
            }

            // Render Minute numbers (5, 10... 60/0) - Outer Ring
            for (let i = 1; i <= 12; i++) {
                const val = i * 5 === 60 ? 0 : i * 5;
                const displayVal = val === 0 ? "00" : val;
                
                const angle = i * 30;
                const radius = 43; // % from center (on the purple ring)
                const x = 50 + radius * Math.sin(angle * Math.PI / 180);
                const y = 50 - radius * Math.cos(angle * Math.PI / 180);

                const el = document.createElement('div');
                // Giảm font size số phút
                el.className = 'absolute text-xs md:text-sm font-bold text-white transform -translate-x-1/2 -translate-y-1/2';
                el.style.left = `${x}%`;
                el.style.top = `${y}%`;
                el.innerText = displayVal;
                clockNumbers.appendChild(el);
            }
        }

        function renderButtons() {
            // Hours 1-12
            for (let i = 1; i <= 12; i++) {
                const btn = document.createElement('button');
                btn.className = `btn-press h-12 md:h-14 rounded-lg text-xl font-bold transition-all duration-200 shadow bg-yellow-300 hover:bg-yellow-400 text-yellow-900 hour-btn`;
                btn.innerText = i;
                btn.dataset.val = i;
                btn.onclick = () => setHour(i);
                hoursGrid.appendChild(btn);
            }

            // Minutes 1-12 (Mapped to 5, 10, 15...)
            for (let i = 1; i <= 12; i++) {
                const minuteVal = i === 12 ? 0 : i * 5;
                const btn = document.createElement('button');
                btn.className = `btn-press h-12 md:h-14 rounded-lg text-xl font-bold transition-all duration-200 shadow bg-purple-500 hover:bg-purple-600 text-white minute-btn`;
                btn.innerText = i;
                btn.dataset.val = minuteVal; // Store actual minute value
                btn.dataset.btnId = i; // Store button ID for styling
                
                // Add tiny subtitle for the minute value
                const sub = document.createElement('span');
                sub.className = "block text-[10px] opacity-70 font-normal";
                sub.innerText = minuteVal === 0 ? ":00" : ":" + minuteVal.toString().padStart(2, '0');
                btn.appendChild(sub);
                // Fix layout to center number and sub
                btn.style.display = 'flex';
                btn.style.flexDirection = 'column';
                btn.style.alignItems = 'center';
                btn.style.justifyContent = 'center';
                btn.firstChild.textContent = i; // Reset text content logic slightly due to span append

                btn.onclick = () => setMinute(minuteVal, i);
                minutesGrid.appendChild(btn);
            }
        }

        // --- Logic ---

        function setHour(h) {
            currentHour = h;
            updateUI();
            hideResult();
        }

        function setMinute(m, btnId) {
            currentMinute = m;
            updateUI();
            hideResult();
        }

        function updateUI() {
            // Update Clock Hands
            const minuteDegree = currentMinute * 6;
            const hourDegree = (currentHour % 12) * 30 + (currentMinute / 60) * 30; // Move hour hand based on minutes

            document.getElementById('minute-hand').style.transform = `rotate(${minuteDegree}deg)`;
            document.getElementById('hour-hand').style.transform = `rotate(${hourDegree}deg)`;
            
            // Update Digital Preview
            const mStr = currentMinute.toString().padStart(2, '0');
            document.getElementById('digital-time').innerText = `${currentHour}:${mStr}`;

            // Update Active Buttons
            document.querySelectorAll('.hour-btn').forEach(b => {
                if (parseInt(b.dataset.val) === currentHour) b.classList.add('active-hour');
                else b.classList.remove('active-hour');
            });

            document.querySelectorAll('.minute-btn').forEach(b => {
                const btnVal = parseInt(b.dataset.val);
                if (btnVal === currentMinute) b.classList.add('active-minute');
                else b.classList.remove('active-minute');
            });
        }

        function toggleResult() {
            const box = document.getElementById('result-box');
            if (box.classList.contains('hidden')) {
                const result = convertToChineseTime(currentHour, currentMinute);
                
                // Set Primary
                document.getElementById('hanzi-result').innerText = result.standard.hanzi;
                document.getElementById('pinyin-result').innerText = result.standard.pinyin;

                // Set Alternatives
                const altContainer = document.getElementById('alternatives-container');
                const altList = document.getElementById('alternatives-list');
                altList.innerHTML = ''; // Clear old

                if (result.alternatives && result.alternatives.length > 0) {
                    altContainer.classList.remove('hidden');
                    result.alternatives.forEach(alt => {
                        const li = document.createElement('li');
                        li.className = "flex justify-between items-center border-b border-yellow-200 pb-1 last:border-0";
                        li.innerHTML = `
                            <span class="text-sm font-semibold text-gray-600 bg-yellow-200 px-2 py-0.5 rounded mr-2 whitespace-nowrap">${alt.type}</span>
                            <div class="text-right">
                                <div class="text-purple-700 font-bold hanzi-text text-lg leading-tight">${alt.hanzi}</div>
                                <div class="text-gray-500 text-xs italic">${alt.pinyin}</div>
                            </div>
                        `;
                        altList.appendChild(li);
                    });
                } else {
                    altContainer.classList.add('hidden');
                }

                box.classList.remove('hidden');
            } else {
                box.classList.add('hidden');
            }
        }

        function hideResult() {
            document.getElementById('result-box').classList.add('hidden');
        }

        // --- Chinese Time Logic ---

        const numbers = {
            0: {h: '零', p: 'líng'},
            1: {h: '一', p: 'yī'},
            2: {h: '二', p: 'èr'},
            3: {h: '三', p: 'sān'},
            4: {h: '四', p: 'sì'},
            5: {h: '五', p: 'wǔ'},
            6: {h: '六', p: 'liù'},
            7: {h: '七', p: 'qī'},
            8: {h: '八', p: 'bā'},
            9: {h: '九', p: 'jiǔ'},
            10: {h: '十', p: 'shí'},
            11: {h: '十一', p: 'shí yī'},
            12: {h: '十二', p: 'shí èr'}
        };

        function getNumberText(num) {
            if (num <= 12) return numbers[num];
            const tens = Math.floor(num / 10);
            const units = num % 10;
            
            let hStr = "";
            let pStr = "";

            if (tens === 1) { // 13-19
                hStr = "十" + (units === 0 ? "" : numbers[units].h);
                pStr = "shí " + (units === 0 ? "" : numbers[units].p);
            } else { // 20-59
                hStr = numbers[tens].h + "十" + (units === 0 ? "" : numbers[units].h);
                pStr = numbers[tens].p + " shí " + (units === 0 ? "" : numbers[units].p);
            }
            return { h: hStr.trim(), p: pStr.trim() };
        }

        function convertToChineseTime(h, m) {
            let alts = [];

            // 1. Basic components
            // Special rule: 2 o'clock is Liǎng (两)
            let hourHanzi = (h === 2) ? "两" : numbers[h].h;
            let hourPinyin = (h === 2) ? "liǎng" : numbers[h].p;
            
            let stdHanzi = "";
            let stdPinyin = "";

            // --- STANDARD CALCULATION ---
            if (m === 0) {
                stdHanzi = `${hourHanzi}点`;
                stdPinyin = `${hourPinyin} diǎn`;
            } else {
                let minHanzi = "";
                let minPinyin = "";

                if (m < 10) {
                    minHanzi = "零" + numbers[m].h;
                    minPinyin = "líng " + numbers[m].p;
                } else {
                    const minObj = getNumberText(m);
                    minHanzi = minObj.h;
                    minPinyin = minObj.p;
                }
                
                stdHanzi = `${hourHanzi}点${minHanzi}分`;
                stdPinyin = `${hourPinyin} diǎn ${minPinyin} fēn`;
            }

            // --- ALTERNATIVES LOGIC ---

            // 1. Half past (Ban - Rưỡi)
            if (m === 30) {
                // For 30, 'Ban' is so common it often replaces standard, 
                // but for teaching let's keep number reading as Standard and Ban as Alt (or vice versa).
                // Let's make "Ban" the standard for this app if you prefer, or keep it consistent.
                // Here: Standard = 30 fen, Alt = Ban.
                alts.push({ 
                    type: "Rưỡi (Bàn)", 
                    hanzi: `${hourHanzi}点半`, 
                    pinyin: `${hourPinyin} diǎn bàn` 
                });
            }

            // 2. Quarter past (Yike - 1 Khắc)
            if (m === 15) {
                alts.push({ 
                    type: "1 Khắc (Yí kè)", 
                    hanzi: `${hourHanzi}点一刻`, 
                    pinyin: `${hourPinyin} diǎn yí kè` 
                });
            }

            // 3. 45 mins (San ke - 3 Khắc)
            if (m === 45) {
                alts.push({ 
                    type: "3 Khắc (Sān kè)", 
                    hanzi: `${hourHanzi}点三刻`, 
                    pinyin: `${hourPinyin} diǎn sān kè` 
                });
            }

            // 4. To/Till (Kém) - Logic: if m >= 45
            if (m >= 45 && m !== 0) {
                const nextH = h === 12 ? 1 : h + 1;
                const remM = 60 - m;
                
                let nextHourHanzi = (nextH === 2) ? "两" : numbers[nextH].h;
                let nextHourPinyin = (nextH === 2) ? "liǎng" : numbers[nextH].p;

                let remMText = getNumberText(remM); 
                
                // Option A: "Cha [min] fen [hour] dian" (Kém X phút nữa là Y giờ)
                alts.push({ 
                    type: `Kém (${remM}p)`, 
                    hanzi: `差${remMText.h}分${nextHourHanzi}点`, 
                    pinyin: `chà ${remMText.p} fēn ${nextHourPinyin} diǎn` 
                });

                // Special case: Kém 1 khắc (Kém 15p)
                if (remM === 15) {
                    alts.push({ 
                        type: "Kém 1 Khắc", 
                        hanzi: `差一刻${nextHourHanzi}点`, 
                        pinyin: `chà yí kè ${nextHourPinyin} diǎn` 
                    });
                }
            }

            return { 
                standard: { hanzi: stdHanzi, pinyin: stdPinyin }, 
                alternatives: alts 
            };
        }

        // Run
        init();

    </script>
</body>
</html>
